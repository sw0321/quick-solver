import { GoogleGenerativeAI } from '@google/generative-ai';document.addEventListener('DOMContentLoaded', () => {  const responseDiv = document.getElementById('response');  const loadingDiv = document.getElementById('loading');  const errorDiv = document.getElementById('error');  const copyButton = document.getElementById('copyButton');  const optionsButton = document.getElementById('optionsButton');  copyButton.addEventListener('click', () => {    navigator.clipboard.writeText(responseDiv.textContent);  });  optionsButton.addEventListener('click', () => {    chrome.runtime.openOptionsPage();  });  chrome.storage.local.get(['selectedText', 'geminiApiKey'], async (result) => {    const selectedText = result.selectedText;    const geminiApiKey = result.geminiApiKey;    if (!geminiApiKey) {      errorDiv.textContent = 'API Key is not set. Please go to settings.';      errorDiv.style.display = 'block';      loadingDiv.style.display = 'none';      return;    }    if (selectedText) {      loadingDiv.style.display = 'block';      responseDiv.textContent = '';      errorDiv.style.display = 'none';      try {        const genAI = new GoogleGenerativeAI(geminiApiKey);        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });        const prompt = `あなたは非常に優秀で、簡潔に要点をまとめて回答するアシスタントです.\n以下の質問に対して、最も適切で分かりやすい回答を日本語で生成してください.\n\n### 質問:\n${selectedText}\n\n### 回答:`;        const result = await model.generateContent(prompt);        const response = await result.response;        const text = response.text();        responseDiv.textContent = text;      } catch (e) {        console.error(e);        errorDiv.textContent = 'Error: ' + e.message;        errorDiv.style.display = 'block';      } finally {        loadingDiv.style.display = 'none';        chrome.storage.local.remove('selectedText');      }    } else {      responseDiv.textContent = 'No text selected. Select text on a webpage and right-click to ask Gemini.';    }  });});