# Gemini活用Q&A Chrome拡張機能 要件定義書兼指示書

## 1. 概要
本ドキュメントは、ウェブページ上のテキストを選択し、Googleの生成AIモデル「Gemini」にその回答を問い合わせるChrome拡張機能「Quick Solver（仮称）」の開発に関する要件と指示を定義するものです。  
ユーザーが学習や情報収集中に遭遇した疑問や問題を、ブラウザから離れることなく迅速に解決できるようにすることを目的とします。

## 2. プロジェクトの目的

- **学習効率の向上**: オンライン教材や記事を読んでいる際に、わからない単語や問題を手軽に解決する。  
- **情報収集の迅速化**: 調べ物中に発生した新たな疑問を、タブを切り替えることなく解消する。  
- **シームレスな体験**: コピーや右クリックといった直感的な操作で、高度なAI機能を利用できる環境を提供する。

## 3. 機能要件

### 3.1. コア機能

| ID     | 機能名                 | 詳細 |
|--------|------------------------|------|
| F-001  | テキスト選択による質問 | ユーザーがウェブページ上のテキストを選択し、右クリックメニューから「Geminiに質問する」を選択できる。 |
| F-002  | Gemini API連携         | 選択されたテキストを質問文として、バックグラウンドでGemini APIにリクエストを送信する。 |
| F-003  | 回答の表示             | Geminiから受け取った回答を、拡張機能のポップアップ画面に表示する。回答が生成されるまではローディング状態を示す。 |

### 3.2. ユーザーインターフェース (UI)

| ID     | 機能名             | 詳細 |
|--------|--------------------|------|
| U-001  | 右クリックメニュー | テキスト選択時に表示される右クリック（コンテキスト）メニューに、本拡張機能の実行項目を追加する。 |
| U-002  | ポップアップウィンドウ | ツールバーの拡張機能アイコンをクリックすると開く。回答の表示、コピーボタン、設定画面へのリンクを配置する。 |
| U-003  | 設定画面           | ユーザーが自身のGemini APIキーを入力・保存できる画面を提供する。 |
| U-004  | ステータス表示     | APIリクエスト中のローディング表示や、エラーが発生した際のメッセージをポップアップ内に明確に表示する。 |

## 4. 非機能要件

| ID     | 項目       | 詳細 |
|--------|------------|------|
| NF-001 | セキュリティ | ユーザーが入力したAPIキーは、`chrome.storage.local` APIを使用して、安全にローカル環境に保存する。外部への送信はGemini APIへのリクエストのみに限定する。 |
| NF-002 | パフォーマンス | APIへのリクエストは非同期で実行し、ブラウザのレンダリングをブロックしないこと。ユーザー操作から3秒以内に回答表示を開始することを目標とする。 |
| NF-003 | 準拠性     | Chrome拡張機能のマニフェストV3に準拠して開発を行う。 |

## 5. 開発技術スタック

- **言語**: JavaScript（TypeScriptの利用を推奨）  
- **API**: Google AI JavaScript SDK（`@google/generative-ai`）  
- **開発ツール**: Gemini CLI, Node.js, npm/yarn  
- **フレームワーク**: 不要（Vanilla JSで十分）または React（UI構築を効率化したい場合）

## 6. Geminiへの指示（プロンプト設計案）

Gemini APIにリクエストを送信する際の、基本的なプロンプトのテンプレートです。

あなたは非常に優秀で、簡潔に要点をまとめて回答するアシスタントです。
以下の質問に対して、最も適切で分かりやすい回答を日本語で生成してください。

### 質問:
${selectionText}

### 回答:
```${selectionText}` の部分に、ユーザーがブラウザで選択したテキストを挿入します。

## 7. MVP（Minimum Viable Product）開発スコープ

まずは、以下の最小限の機能を持つバージョンを開発し、リリースを目指します。

1.  **右クリックメニューからの質問機能の実装** (F-001)
2.  **バックグラウンドでのGemini API連携** (F-002)
3.  **ポップアップでのシンプルなテキスト回答表示** (F-003)
4.  **手動でのAPIキー設定機能** (U-003)
